# pymelos workspace configuration
name: flash-framework

packages:
  - packages/*
  - apps/*

scripts:
  test:
    description: Run tests
    run: |
      if [ -d tests ] && [ "$(ls -A tests)" ]; then
        pytest tests/ -v --tb=short --cov=src --cov-report=term-missing
      else
        echo "No tests found"
      fi
  lint:
    run: ruff check .
    description: Run linting

  format:
    run: ruff format .
    description: Format code

  ty:
    run: |
      if [ -d src ]; then
        ty check src/
      else
        ty check .
      fi
    description: Run type checking

command_defaults:
  concurrency: 4
  fail_fast: false
  topological: true

clean:
  patterns:
    - "__pycache__"
    - "*.pyc"
    - ".pytest_cache"
    - ".mypy_cache"
    - ".ruff_cache"
    - "*.egg-info"
    - "dist"
    - "build"
  protected:
    - ".venv"
    - ".git"

versioning:
  commit_format: conventional
  tag_format: "{name}@{version}"
  changelog:
    enabled: true
    filename: CHANGELOG.md
